---
name: invoice-organizer
description: 通过读取杂乱的文件、提取关键信息、一致性重命名并分类到逻辑文件夹中，自动为税务准备整理发票和收据。将数小时的手动记账转化为几分钟的自动化整理。
---

# 发票整理器

此技能无需手动操作，即可将混乱的发票、收据和财务文件文件夹转换为整洁、可用于税务申报的归档系统。

## 何时使用此技能

- 准备税务申报，需要整理有序的记录
- 管理来自多个供应商的业务支出
- 整理来自杂乱文件夹或电子邮件下载的收据
- 为持续记账设置自动发票归档
- 按年份或类别归档财务记录
- 核对报销费用
- 为会计师准备文档

## 此技能的功能

1. **读取发票内容**：从PDF、图像和文档中提取信息：
   - 供应商/公司名称
   - 发票编号
   - 日期
   - 金额
   - 产品或服务描述
   - 支付方式

2. **一致性重命名文件**：创建标准化文件名：
   - 格式：`YYYY-MM-DD 供应商 - 发票 - 产品或服务.pdf`
   - 示例：`2024-03-15 Adobe - 发票 - Creative Cloud.pdf`

3. **按类别组织**：分类到逻辑文件夹：
   - 按供应商
   - 按支出类别（软件、办公用品、差旅等）
   - 按时间段（年、季度、月）
   - 按税务类别（可抵扣、个人等）

4. **处理多种格式**：支持：
   - PDF发票
   - 扫描收据（JPG、PNG）
   - 电子邮件附件
   - 屏幕截图
   - 银行对账单

5. **保留原始文件**：在整理副本时保留原始文件

## 使用方法

### 基本用法

导航到您混乱的发票文件夹：
```
cd ~/Desktop/待整理收据
```

然后向Claude Code请求：
```
整理这些发票用于税务申报
```

或更具体地：
```
读取此文件夹中的所有发票，将它们重命名为
"YYYY-MM-DD 供应商 - 发票 - 产品.pdf" 格式，
并按供应商组织
```

### 高级组织

```
整理这些发票：
1. 从每个文件中提取日期、供应商和描述
2. 重命名为标准格式
3. 按支出类别（软件、办公用品、差旅等）分类到文件夹
4. 为我的会计师创建包含所有发票详细信息的CSV电子表格
```

## 操作说明

当用户请求发票整理时：

1. **扫描文件夹**
   
   识别所有发票文件：
   ```bash
   # 查找所有与发票相关的文件
   find . -type f \( -name "*.pdf" -o -name "*.jpg" -o -name "*.png" \) -print
   ```
   
   报告发现：
   - 文件总数
   - 文件类型
   - 日期范围（如果可以从名称中辨别）
   - 当前组织情况（或缺乏组织）

2. **从每个文件中提取信息**
   
   为每个发票提取：
   
   **从PDF发票中**：
   - 使用文本提取读取发票内容
   - 查找常见模式：
     - "Invoice Date:"（发票日期）、"Date:"（日期）、"Issued:"（开具日期）
     - "Invoice #:"（发票编号）、"Invoice Number:"（发票编号）
     - 公司名称（通常在顶部）
     - "Amount Due:"（应付金额）、"Total:"（总计）、"Amount:"（金额）
     - "Description:"（描述）、"Service:"（服务）、"Product:"（产品）
   
   **从图像收据中**：
   - 读取图像中的可见文本
   - 识别供应商名称（通常在顶部）
   - 查找日期（常见格式）
   - 查找总金额
   
   **不清晰文件的备选方案**：
   - 使用文件名线索
   - 检查文件创建/修改日期
   - 如果关键信息缺失，标记为需要手动审查

3. **确定组织策略**
   
   如果未指定，询问用户偏好：
   
   ```markdown
   我找到了[X]张发票，日期范围为[日期范围]。
   
   您希望如何组织它们？
   
   1. **按供应商**（Adobe/、Amazon/、Stripe/等）
   2. **按类别**（软件/、办公用品/、差旅/等）
   3. **按日期**（2024/Q1/、2024/Q2/等）
   4. **按税务类别**（可抵扣/、个人/等）
   5. **自定义**（描述您的结构）
   
   或者我可以使用默认结构：年份/类别/供应商
   ```

4. **创建标准化文件名**
   
   为每个发票创建遵循以下模式的文件名：
   
   ```
   YYYY-MM-DD 供应商 - 发票 - 描述.ext
   ```
   
   示例：
   - `2024-03-15 Adobe - 发票 - Creative Cloud.pdf`
   - `2024-01-10 Amazon - 收据 - 办公用品.pdf`
   - `2023-12-01 Stripe - 发票 - 月度支付处理.pdf`
   
   **文件名最佳实践**：
   - 移除除连字符外的特殊字符
   - 正确大写供应商名称
   - 保持描述简洁但有意义
   - 使用一致的日期格式（YYYY-MM-DD）以便排序
   - 保留原始文件扩展名

5. **执行组织操作**
   
   在移动文件前，展示计划：
   
   ```markdown
   # 组织计划
   
   ## 建议结构
   ```
   Invoices/
   ├── 2023/
   │   ├── Software/
   │   │   ├── Adobe/
   │   │   └── Microsoft/
   │   ├── Services/
   │   └── Office/
   └── 2024/
       ├── Software/
       ├── Services/
       └── Office/
   ```
   
   ## 示例更改
   
   之前：`invoice_adobe_march.pdf`
   之后：`2024-03-15 Adobe - 发票 - Creative Cloud.pdf`
   位置：`Invoices/2024/Software/Adobe/`
   
   之前：`IMG_2847.jpg`
   之后：`2024-02-10 Staples - 收据 - 办公用品.jpg`
   位置：`Invoices/2024/Office/Staples/`
   
   处理[X]个文件？（是/否）
   ```
   
   获得批准后：
   ```bash
   # 创建文件夹结构
   mkdir -p "Invoices/2024/Software/Adobe"
   
   # 复制（不移动）以保留原始文件
   cp "original.pdf" "Invoices/2024/Software/Adobe/2024-03-15 Adobe - 发票 - Creative Cloud.pdf"
   
   # 如果用户偏好，也可以移动
   mv "original.pdf" "new/path/standardized-name.pdf"
   ```

6. **生成摘要报告**
   
   创建包含所有发票详细信息的CSV文件：
   
   ```csv
   Date,Vendor,Invoice Number,Description,Amount,Category,File Path
   2024-03-15,Adobe,INV-12345,Creative Cloud,52.99,Software,Invoices/2024/Software/Adobe/2024-03-15 Adobe - 发票 - Creative Cloud.pdf
   2024-03-10,Amazon,123-4567890-1234567,Office Supplies,127.45,Office,Invoices/2024/Office/Amazon/2024-03-10 Amazon - 收据 - 办公用品.pdf
   ...
   ```
   
   此CSV的用途：
   - 导入到会计软件
   - 与会计师共享
   - 支出跟踪和报告
   - 税务准备

7. **提供完成摘要**
   
   ```markdown
   # 组织完成！📊
   
   ## 摘要
   - **已处理**：[X]张发票
   - **日期范围**：[最早日期]至[最晚日期]
   - **总金额**：$[总和]（如果提取了金额）
   - **供应商**：[Y]个唯一供应商
   
   ## 新结构
   ```
   Invoices/
   ├── 2024/ (45个文件)
   │   ├── Software/ (23个文件)
   │   ├── Services/ (12个文件)
   │   └── Office/ (10个文件)
   └── 2023/ (12个文件)
   ```
   
   ## 创建的文件
   - `/Invoices/` - 已整理的发票
   - `/Invoices/invoice-summary.csv` - 会计用电子表格
   - `/Invoices/originals/` - 原始文件（如果已复制）
   
   ## 需要审查的文件
   [列出所有无法完全提取信息的文件]
   
   ## 后续步骤
   1. 审查 `invoice-summary.csv` 文件
   2. 检查"需要审查"文件夹中的文件
   3. 将CSV导入您的会计软件
   4. 为未来的发票设置自动组织
   
   税务申报已准备就绪！🎉
   ```

## 示例

### 示例1：税务准备（来自Martin Merschroth）

**用户**："我有一个杂乱的发票文件夹用于税务申报。请对它们进行排序并正确重命名。"

**流程**：
1. 扫描文件夹：找到147个PDF和图像文件
2. 读取每张发票以提取：
   - 日期
   - 供应商名称
   - 发票编号
   - 产品/服务描述
3. 将所有文件重命名为：`YYYY-MM-DD 供应商 - 发票 - 产品.pdf`
4. 组织到：`2024/Software/`、`2024/Travel/`等文件夹
5. 为会计师创建 `invoice-summary.csv`
6. 结果：几分钟内完成可用于税务申报的发票整理

### 示例2：月度支出核对

**用户**："按类别整理我上个月的业务收据。"

**输出**：
```markdown
# 2024年3月收据已整理

## 按类别
- 软件与工具：$847.32（12张发票）
- 办公用品：$234.18（8张收据）
- 差旅与餐饮：$1,456.90（15张收据）
- 专业服务：$2,500.00（3张发票）

总计：$5,038.40

所有收据已重命名并归档到：
`Business-Receipts/2024/03-March/[Category]/`

CSV导出：`march-2024-expenses.csv`
```

### 示例3：多年归档

**用户**："我有3年的随机发票。请按年份，然后按供应商组织它们。"

**输出**：创建结构：
```
Invoices/
├── 2022/
│   ├── Adobe/
│   ├── Amazon/
│   └── ...
├── 2023/
│   ├── Adobe/
│   ├── Amazon/
│   └── ...
└── 2024/
    ├── Adobe/
    ├── Amazon/
    └── ...
```

每个文件都已使用日期和描述正确重命名。

### 示例4：电子邮件下载清理

**用户**："我从Gmail下载发票。它们都命名为'invoice.pdf'、'invoice(1).pdf'等。请修复这个混乱的情况。"

**输出**：
```markdown
找到89个都命名为"invoice*.pdf"的文件

正在读取每个文件以提取真实信息...

重命名示例：
- invoice.pdf → 2024-03-15 Shopify - 发票 - 月度订阅.pdf
- invoice(1).pdf → 2024-03-14 Google - 发票 - Workspace.pdf
- invoice(2).pdf → 2024-03-10 Netlify - 发票 - Pro Plan.pdf

所有文件已重命名并按供应商组织。
```

## 常见组织模式

### 按供应商（简单）
```
Invoices/
├── Adobe/
├── Amazon/
├── Google/
└── Microsoft/
```

### 按年份和类别（便于税务申报）
```
Invoices/
├── 2023/
│   ├── Software/
│   ├── Hardware/
│   ├── Services/
│   └── Travel/
└── 2024/
    └── ...
```

### 按季度（详细跟踪）
```
Invoices/
├── 2024/
│   ├── Q1/
│   │   ├── Software/
│   │   ├── Office/
│   │   └── Travel/
│   └── Q2/
│       └── ...
```

### 按税务类别（便于会计师使用）
```
Invoices/
├── Deductible/
│   ├── Software/
│   ├── Office/
│   └── Professional-Services/
├── Partially-Deductible/
│   └── Meals-Travel/
└── Personal/
```

## 自动化设置

对于持续的组织：

```
创建一个脚本，监视我的 ~/Downloads/invoices 文件夹
并使用我们的标准命名和文件夹结构自动组织任何新的发票文件。
```

这将创建一个持久的解决方案，在发票到达时自动组织它们。

## 专业提示

1. **将电子邮件扫描为PDF**：首先使用Preview或类似工具将电子邮件发票保存为PDF
2. **一致的下载**：将所有发票保存到一个文件夹中进行批处理
3. **月度例行程序**：按月组织发票，而不是按年
4. **备份原始文件**：在重新组织之前保留原始文件
5. **在CSV中包含金额**：便于预算跟踪
6. **按可抵扣性标记**：注明哪些支出可以抵税
7. **保留收据7年**：标准审计期

## 处理特殊情况

### 信息缺失
如果无法提取日期/供应商：
- 将文件标记为需要手动审查
- 使用文件修改日期作为备选
- 创建"Needs-Review/"文件夹

### 重复发票
如果同一张发票多次出现：
- 比较文件哈希值
- 保留最高质量版本
- 在摘要中注明重复项

### 多页发票
对于跨文件拆分的发票：
- 如果需要，合并PDF
- 对各部分使用一致的命名
- 如果发票已拆分，在CSV中注明

### 非标准格式
对于不寻常的收据格式：
- 提取可能的信息
- 标准化可以标准化的内容
- 如果关键信息缺失，标记为需要审查

## 相关用例

- 创建用于报销的支出报告
- 整理银行对账单
- 管理供应商合同
- 归档旧财务记录
- 准备审计
- 随时间跟踪订阅成本

