# 从规范创建任务

## 查找任务数据库

在创建任务之前，定位任务数据库：

```
1. 搜索任务数据库：
   Notion:notion-search
   query: "Tasks" 或 "Task Management" 或 "[Project] Tasks"
   
2. 获取数据库模式：
   Notion:notion-fetch
   id: "database-id-from-search"
   
3. 识别数据源：
   - 查找 <data-source url="collection://..."> 标签
   - 提取集合 ID 用于 parent 参数
   
4. 记录模式：
   - 必需属性
   - 属性类型和选项
   - 用于链接的关系属性

示例：
Notion:notion-search
query: "Engineering Tasks"
query_type: "internal"

Notion:notion-fetch
id: "tasks-database-id"
```

结果：`collection://abc-123-def` 用作 parent

## 任务分解策略

### 规模指导原则

**良好的任务规模**：
- 1-2 天内可完成
- 单个明确的可交付成果
- 可独立测试
- 最小依赖关系

**过大**：
- 超过 3 天
- 多个可交付成果
- 许多依赖
- 需要进一步分解

**过小**：
- 少于 2 小时
- 过于细化
- 与相关工作分组

### 按阶段细化

**早期阶段**：较大的任务可接受
- "设计数据库模式"
- "设置 API 结构"

**中期阶段**：中等规模的任务
- "实现用户身份验证"
- "构建仪表板 UI"

**后期阶段**：较小、精确的任务
- "修复表单中的验证错误"
- "为按钮添加加载状态"

## 任务创建模式

对于每个需求或工作项：

```
1. 识别工作
2. 确定任务规模
3. 在数据库中创建任务
4. 设置属性
5. 编写任务描述
6. 链接到规范/计划
```

### 创建任务

```
使用 Notion:notion-create-pages：

parent: {
  type: "data_source_id",
  data_source_id: "collection://tasks-db-uuid"
}

properties: {
  "[Title Property]": "Task: [清晰的任务名称]",
  "Status": "To Do",
  "Priority": "[High/Medium/Low]",
  "[Project/Related]": ["spec-page-id", "plan-page-id"],
  "Assignee": "[人员]" (如果已知),
  "date:Due Date:start": "[日期]" (如果适用),
  "date:Due Date:is_datetime": 0
}

content: "[使用模板的任务描述]"
```

## 任务描述模板

```markdown
# [任务名称]

## 上下文
<mention-page url="...">功能规范</mention-page> 的实施任务

属于 <mention-page url="...">实施计划</mention-page> - 阶段 [N]

## 目标
[此任务完成的内容]

## 需求
基于规范需求：
- [相关需求 1]
- [相关需求 2]

## 验收标准
- [ ] [具体、可测试的标准]
- [ ] [具体、可测试的标准]
- [ ] [具体、可测试的标准]

## 技术方法
[建议的实施方法]

### 受影响的组件
- [组件 1]
- [组件 2]

### 关键决策
- [决策点 1]
- [决策点 2]

## 依赖关系

### 被阻塞于
- <mention-page url="...">前置任务</mention-page> 或 无

### 阻塞
- <mention-page url="...">依赖任务</mention-page> 或 无

## 资源
- [设计模型链接]
- [API 规范链接]
- [相关代码链接]

## 预计工作量
[时间估算]

## 进度
[实施过程中更新]
```

## 任务类型

### 基础设施/设置任务

```
标题: "Setup: [正在设置的内容]"
示例：
- "Setup: 配置数据库连接池"
- "Setup: 初始化身份验证中间件"
- "Setup: 创建 CI/CD 流水线"

重点: 准备环境/工具
```

### 功能实施任务

```
标题: "Implement: [功能名称]"
示例：
- "Implement: 用户登录流程"
- "Implement: 文件上传功能"
- "Implement: 仪表板小部件"

重点: 构建特定功能
```

### 集成任务

```
标题: "Integrate: [正在集成的内容]"
示例：
- "Integrate: 连接前端到 API"
- "Integrate: 添加支付提供商"
- "Integrate: 将用户资料链接到仪表板"

重点: 连接组件
```

### 测试任务

```
标题: "Test: [正在测试的内容]"
示例：
- "Test: 编写身份验证服务的单元测试"
- "Test: 结账流程的端到端测试"
- "Test: API 性能测试"

重点: 验证和质量保证
```

### 文档任务

```
标题: "Document: [正在记录的内容]"
示例：
- "Document: API 端点"
- "Document: 设置说明"
- "Document: 架构决策"

重点: 创建文档
```

### 错误修复任务

```
标题: "Fix: [错误描述]"
示例：
- "Fix: Safari 上的登录错误"
- "Fix: 图像处理中的内存泄漏"
- "Fix: 支付流程中的竞态条件"

重点: 解决问题
```

### 重构任务

```
标题: "Refactor: [正在重构的内容]"
示例：
- "Refactor: 将身份验证逻辑提取到服务"
- "Refactor: 优化数据库查询"
- "Refactor: 简化组件层次结构"

重点: 代码质量改进
```

## 任务排序

### 关键路径

识别必须首先发生的任务：

```
1. 数据库模式
2. API 基础
3. 核心业务逻辑
4. 前端集成
5. 测试
6. 部署
```

### 并行轨道

可以同时进行的任务：

```
轨道 A: 后端开发
- API 端点
- 业务逻辑
- 数据库操作

轨道 B: 前端开发
- UI 组件
- 状态管理
- 路由

轨道 C: 基础设施
- CI/CD 设置
- 监控
- 文档
```

### 基于阶段的排序

按实施阶段分组：

```
阶段 1（基础）：
- 设置任务
- 基础设施任务

阶段 2（核心）：
- 功能实施任务
- 集成任务

阶段 3（完善）：
- 测试任务
- 文档任务
- 优化任务
```

## 优先级分配

### P0/关键
- 阻塞其他所有内容
- 核心功能
- 安全要求
- 数据完整性

### P1/高
- 重要功能
- 面向用户的功能
- 性能要求

### P2/中
- 最好有的功能
- 优化
- 小改进

### P3/低
- 未来增强
- 边缘情况处理
- 外观改进

## 估算

### 故事点

如果使用故事点：
- 1 点：几小时
- 2 点：半天
- 3 点：一天
- 5 点：2 天
- 8 点：3-4 天（考虑分解）

### 时间估算

直接时间估算：
- 2-4 小时：小任务
- 1 天：中等任务
- 2 天：大任务
- 3+ 天：进一步分解

### 估算因素

考虑：
- 复杂性
- 未知因素
- 依赖关系
- 测试要求
- 文档需求

## 任务关系

### 父任务模式

对于大型功能：

```
父任务: "Feature: 用户身份验证"
子任务：
- "Setup: 配置身份验证库"
- "Implement: 登录流程"
- "Implement: 密码重置"
- "Test: 身份验证功能"
```

### 依赖链模式

对于顺序工作：

```
任务 A: "设计数据库模式"
↓ (阻塞)
任务 B: "实现数据模型"
↓ (阻塞)
任务 C: "创建 API 端点"
↓ (阻塞)
任务 D: "与前端集成"
```

### 相关任务模式

对于并行工作：

```
中心: "Feature: 仪表板"
相关：
- "仪表板数据的后端 API"
- "前端仪表板组件"
- "仪表板数据缓存"
```

## 批量任务创建

创建多个任务时：

```
对于分解中的每个工作项：
  1. 确定任务属性
  2. 创建任务页面
  3. 链接到规范/计划
  4. 设置关系

然后：
  1. 用任务链接更新计划
  2. 审查排序
  3. 分配任务（如果已知）
```

## 任务命名约定

**具体明确**：
✓ "使用电子邮件/密码实现用户登录"
✗ "添加登录"

**包含上下文**：
✓ "Dashboard: 添加收入图表小部件"
✗ "添加图表"

**使用动作动词**：
- Implement, Build, Create（实施、构建、创建）
- Integrate, Connect, Link（集成、连接、链接）
- Fix, Resolve, Debug（修复、解决、调试）
- Test, Validate, Verify（测试、验证、核实）
- Document, Write, Update（记录、编写、更新）
- Refactor, Optimize, Improve（重构、优化、改进）

## 验证清单

在确定任务之前：

☐ 每个任务都有明确的目标
☐ 验收标准可测试
☐ 已识别依赖关系
☐ 规模适当（1-2 天）
☐ 已分配优先级
☐ 已链接到规范/计划
☐ 排序正确
☐ 已注明资源
